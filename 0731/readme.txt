optimize
1: data and index output simultaneous
2: reduce ram size
3: change multi-thread structure
